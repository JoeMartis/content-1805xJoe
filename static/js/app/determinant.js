(function(requirejs,require,define){define("app/determinant",["require","jquery","webfonts","utils","tool","color","checkbox","text","vector2d","graph"],function(require){var $=require("jquery"),WebFonts=require("webfonts"),U=require("utils"),Tool=require("tool"),Color=require("color"),Checkbox=require("checkbox"),Text=require("text"),Vector2d=require("vector2d"),Graph=require("graph"),tool,graph,vTitle,vLabel,vxText,vyText,wTitle,wLabel,wxText,wyText,det,detLabel0,detLabel1,detLabel2,detLabel3,detLabel4,detLabel5,detLabel6,vSelected=!1,wSelected=!1,v,w;WebFonts.load(initializeTool);function initializeTool(){try{U.testForFeatures(!0,!1,!1),initTool(),draw()}catch(err){window.alert(err.toString()+" The tool is disabled.")}}function loadJSON(){$.ajax({url:"config.json",dataType:"json",success:function(data){$.each(data,function(key,val){window.alert("key="+key+" "+"val="+val)})}})}function initTool(){var daimpCanvas=$("#daimp")[0];daimpCanvas.onselectstart=function(){return!1};var daimpBuffer=
document.createElement("canvas");daimpBuffer.width=daimpCanvas.width,daimpBuffer.height=daimpCanvas.height;var element=$("#daimp");tool=new Tool(800,800,daimpCanvas,daimpBuffer,element),graph=new Graph(90,40,390,340),setGraph(),graph.addEventListener("mousedown",graphMouseDown),graph.addEventListener("mousedrag",graphMouseDrag),tool.add(graph),setGraph(),v=new Vector2d(4,2),vTitle=new Text(555,60,0,0),vTitle.text="v",vTitle.textColor=Color.yellow,vTitle.textAlign="center",tool.add(vTitle),vxText=new Text(540,100,0,0),vxText.text=v.x.toFixed(2),vxText.textColor=Color.yellow,tool.add(vxText),vyText=new Text(540,130,0,0),vyText.text=v.y.toFixed(2),vyText.textColor=Color.yellow,tool.add(vyText),detLabel0=new Text(490,115,0,0),detLabel0.text="det ",detLabel0.textColor=Color.litegray,tool.add(detLabel0),w=new Vector2d(1,3),wTitle=new Text(615,60,0,0),wTitle.text="w",wTitle.textColor=Color.cyan,wTitle.textAlign="center",tool.add(wTitle),wxText=new Text(600,100,0,0),wxText.text=w.x.toFixed(2),wxText
.textColor=Color.cyan,tool.add(wxText),wyText=new Text(600,130,0,0),wyText.text=w.y.toFixed(2),wyText.textColor=Color.cyan,tool.add(wyText),detLabel1=new Text(650,115,0,0),detLabel1.text=" = vx.wy - vy.wx",detLabel1.textColor=Color.litegray,tool.add(detLabel1),detLabel2=new Text(650,165,0,0),calculateDet1(),detLabel2.text=" = "+getDetStr1(),detLabel2.textColor=Color.litegray,tool.add(detLabel2),detLabel3=new Text(617,235,0,0),detLabel3.text="Area = b.h",detLabel3.textColor=Color.solOrange,tool.add(detLabel3),detLabel4=new Text(650,285,0,0),calculateDet2(),detLabel4.text=" = "+getDetStr2(),detLabel4.textColor=Color.solOrange,tool.add(detLabel4),detLabel5=new Text(626,355,0,0),detLabel5.text="v.w = |v||w|cos \u03b8",detLabel5.textColor=Color.litegray,tool.add(detLabel5),detLabel6=new Text(650,405,0,0),calculateDet3(),detLabel6.text=" = "+getDetStr3(),detLabel6.textColor=Color.litegray,tool.add(detLabel6)}function setGraph(){graph.xText="x",graph.yText="y",graph.xmin=-6,graph.xmax=6,graph.
xspan=12,graph.xShortTickMin=0,graph.xShortTickMax=0,graph.xShortTickStep=0,graph.xLongTickMin=-6,graph.xLongTickMax=6,graph.xLongTickStep=1,graph.xLabelMin=-6,graph.xLabelMax=6,graph.xLabelStep=1,graph.xGridMin=-5,graph.xGridMax=5,graph.xGridStep=1,graph.xLabelDecimalDigits=0,graph.ymin=-6,graph.ymax=6,graph.yspan=12,graph.yShortTickMin=0,graph.yShortTickMax=0,graph.yShortTickStep=0,graph.yLongTickMin=-6,graph.yLongTickMax=6,graph.yLongTickStep=1,graph.yLabelMin=-6,graph.yLabelMax=6,graph.yLabelStep=1,graph.yGridMin=-5,graph.yGridMax=5,graph.yGridStep=1,graph.yLabelDecimalDigits=0,graph.x0=0,graph.y0=0,graph.showHorizontalCrosshair=!1,graph.showVerticalCrosshair=!1}function generateBuffer(){}function graphMouseDown(args){var distv=distance(v.x,v.y,args.x,args.y),distw=distance(w.x,w.y,args.x,args.y);distv<=distw?(v.x=args.x,v.y=args.y,vSelected=!0,wSelected=!1):(w.x=args.x,w.y=args.y,wSelected=!0,vSelected=!1),update()}function graphMouseDrag(args){vSelected?(v.x=args.x,v.y=args.y):(w.
x=args.x,w.y=args.y),v.x>graph.xmax?v.x=graph.xmax:v.x<graph.xmin&&(v.x=graph.xmin),v.y>graph.ymax?v.y=graph.ymax:v.y<graph.ymin&&(v.y=graph.ymin),w.x>graph.xmax?w.x=graph.xmax:w.x<graph.xmin&&(w.x=graph.xmin),w.y>graph.ymax?w.y=graph.ymax:w.y<graph.ymin&&(w.y=graph.ymin),update()}function distance(x1,y1,x2,y2){return Math.sqrt((x2-x1)*(x2-x1)+(y2-y1)*(y2-y1))}function update(){updateGraph(),updateTexts()}function updateGraph(){graph.updateDrawingZone();var vmag=v.mag(),vphase=v.phase(),wmag=w.mag(),wphase=w.phase(),vdotw=dot(v,w),projwv,sumvw;if(vmag!==0&&wmag!==0){projwv=projection(w,v),sumvw=add(v,w);var xx=[0,v.x,sumvw.x,w.x],yy=[0,v.y,sumvw.y,w.y];graph.fillShape(xx,yy,Color.solOrange),graph.drawLine(0,0,projwv.x,projwv.y,Color.sOlorange),graph.drawLine(v.x,v.y,sumvw.x,sumvw.y,Color.midgray),graph.drawLine(w.x,w.y,sumvw.x,sumvw.y,Color.midgray),graph.drawLine(w.x,w.y,projwv.x,projwv.y,Color.solOrange),graph.drawArc(0,0,25,vphase,wphase,!0,Color.green)}vmag!==0?graph.drawArrow(0,0,v
.x,v.y,Color.yellow):graph.drawPoint(0,0,Color.yellow),wmag!==0?graph.drawArrow(0,0,w.x,w.y,Color.cyan):graph.drawPoint(0,0,Color.cyan),graph.drawPoint(projwv.x,projwv.y,Color.solOrange)}function updateTexts(){vxText.text=v.x.toFixed(2),vyText.text=v.y.toFixed(2),vxText.draw(),vyText.draw(),wxText.text=w.x.toFixed(2),wyText.text=w.y.toFixed(2),wxText.draw(),wyText.draw(),calculateDet1(),detLabel2.text=" = "+getDetStr1(),detLabel2.draw(),calculateDet2(),detLabel4.text=" = "+getDetStr2(),detLabel4.draw(),calculateDet3(),detLabel6.text=" = "+getDetStr3(),detLabel6.draw(),tool.drawLeftBracket(520,80,50,Color.litegray),tool.drawRightBracket(645,80,50,Color.litegray)}function draw(){tool.setPaintOn("canvas"),tool.paint(),update()}function calculateDet1(){det=v.x*w.y-v.y*w.x}function calculateDet2(){det=v.mag()*height(w,v).mag()}function calculateDet3(){det=v.mag()*w.mag()*Math.cos(phase(v,w))}function getDetStr1(){return"("+v.x.toFixed(2)+").("+w.y.toFixed(2)+") - ("+w.x.toFixed(2)+").("+v.y.
toFixed(2)+") = "+det.toFixed(2)}function getDetStr2(){return"("+v.mag().toFixed(2)+").("+height(w,v).mag().toFixed(2)+") = "+det.toFixed(2)}function getDetStr3(){return"("+v.mag().toFixed(2)+").("+w.mag().toFixed(2)+").("+Math.cos(phase(v,w)).toFixed(2)+") = "+det.toFixed(2)}function dot(v,w){return v.x*w.x+v.y*w.y}function phase(v,w){return w.phase()-v.phase()}function normalize(v){return new Vector2d(v.x/v.mag(),v.y/v.mag())}function projection(w,v){var projmag=dot(v,w)/v.mag(),proj=normalize(v);return proj.scale(projmag),proj}function height(w,v){var h=substract(w,projection(w,v));return h}function add(v,w){var sum=new Vector2d(v.x+w.x,v.y+w.y);return sum}function substract(v,w){var sub=new Vector2d(v.x-w.x,v.y-w.y);return sub}})})(RequireJS.requirejs,RequireJS.require,RequireJS.define)